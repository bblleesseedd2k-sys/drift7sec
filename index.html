<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Drift Countdown Animation</title>

<!-- üîπ –ü–æ–¥–∫–ª—é—á–∞–µ–º –Ω—É–∂–Ω—ã–π —à—Ä–∏—Ñ—Ç -->
<link href="https://fonts.googleapis.com/css?family=Kdam+Thmor&display=swap" rel="stylesheet">

<style>
  body {
    margin: 0;
    font-family: "Kdam Thmor", system-ui, sans-serif;
    background: #000;
    height: 100vh;
    overflow: hidden;
  }

  /* —Ñ–æ–Ω ‚Äî —Ç–≤–æ–π –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–∞–∫–µ—Ç */
  #captureZone {
    position: relative;
    width: 1280px;
    height: 629px;
    margin: 0 auto;
    background: url("background.jpg") center/cover no-repeat;
  }

  /* –ö—Ä–∞—Å–Ω–∞—è –∑–æ–Ω–∞ ‚Äî WARNING + —Ç–∞–π–º–µ—Ä */
  .warning-area {
    position: absolute;
    top: 100px; left: 415px;
    width: 600px; text-align: center;
    color: white;
  }
  .warning-area h1 {
    color: #e64a4a;
    font-size: 58px;
    margin-bottom: 2px;
  }
  .warning-area .sub {
    font-size: 40px;
    margin-bottom: 2px;
  }
  .timer {
    font-size: 58px;
    font-weight: 400;
    color: #e64a4a;
  }

  /* –°–∏–Ω—è—è –∑–æ–Ω–∞ ‚Äî –Ω–æ–º–µ—Ä */
  .phone {
    position: absolute;
    top: 441px; left: 625px;
    font-size: 24px; font-weight: 400;
    color: black;
    letter-spacing: 1px;
  }

  /* –ó–µ–ª—ë–Ω–∞—è –∑–æ–Ω–∞ ‚Äî —Å—É–º–º—ã */
  .amounts {
    position: absolute;
    top: 520px;
    left: 56%;
    transform: translateX(-50%);
    width: auto;
    font-size: 24px;
    color: white;
    text-align: center;
    white-space: nowrap; /* —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–Ω–æ—Å–∏–ª–∏—Å—å —Å—Ç—Ä–æ–∫–∏ */
  }

  .amounts b { color: white; }

  /* –ñ—ë–ª—Ç–∞—è –∑–æ–Ω–∞ ‚Äî –∏–º—è */
  .username {
    position: absolute;
    bottom: 20px; left: 62px;
    color: #ccc;
    font-size: 18px;
  }

  /* –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–Ω–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –≤–∏–¥–µ–æ) */
  .controls {
    position: fixed;
    bottom: 10px; right: 10px;
    background: rgba(0,0,0,0.6);
    color: #fff;
    padding: 12px 16px;
    border-radius: 10px;
    font-size: 14px;
    z-index: 20;
  }
  .controls label {
    display: block;
    margin-top: 6px;
  }
  .controls input {
    width: 200px;
    padding: 4px 6px;
    margin-top: 2px;
    border-radius: 4px;
    border: none;
  }
  .controls button {
    margin-top: 10px;
    background: #e64a4a;
    color: #fff;
    border: none;
    padding: 8px 10px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 400;
  }

  #canvasRecorder { display: none; }
</style>
</head>
<body>
  <div id="captureZone">
    <div class="warning-area">
      <h1>WARNING</h1>
      <div class="sub">PROFIT WILL BE CANCELLED IN</div>
      <div class="timer" id="timer">00:00:07</div>
    </div>

    <div class="phone" id="phone">01145852502</div>

    <div class="amounts">
      THE AMOUNT TO BE PAID IS <span id="amount1">24,899</span> EGP<br>
      TO THE CONCLUSION: <span id="amount2">248,099.08</span> EGP
    </div>

    <div class="username" id="username">Yara Mohamed</div>
  </div>

  <div class="controls" id="controls">
    <label>‚è± –í—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ (HH:MM:SS): <input id="inputTimer" type="text" value="12:00:00"></label>
    <label>üìû –ù–æ–º–µ—Ä: <input id="inputPhone" type="text" value="01145852502"></label>
    <label>üí∞ –°—É–º–º–∞ –ø–ª–∞—Ç–µ–∂–∞: <input id="inputAmt1" type="text" value="24,899"></label>
    <label>üìà –°—É–º–º–∞ –ø—Ä–∏–±—ã–ª–∏: <input id="inputAmt2" type="text" value="248,099.08"></label>
    <label>üë§ –ò–º—è: <input id="inputName" type="text" value="Yara Mohamed"></label>
    <label>üé¨ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤–∏–¥–µ–æ (—Å–µ–∫): <input id="inputDuration" type="number" value="7" min="1" max="60"></label>
    <button onclick="applyData()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
    <button onclick="startCountdown()">Start</button>
    <button onclick="recordVideo()">üé• –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–∏–¥–µ–æ</button>
  </div>

  <canvas id="canvasRecorder"></canvas>

<script>
let countdown = 7;
let timerInterval;
function pad(n){return n.toString().padStart(2,"0");}
function fmt(s){const h=Math.floor(s/3600),m=Math.floor((s%3600)/60),sec=s%60;return `${pad(h)}:${pad(m)}:${pad(sec)}`;}

function updateTimer(){
  document.getElementById("timer").textContent = fmt(countdown);
}

function startCountdown(){
  clearInterval(timerInterval);

  // –ë–µ—Ä–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤—ë–ª –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM:SS
  const input = document.getElementById("inputTimer").value.trim();
  const parts = input.split(":").map(Number);
  if (parts.length !== 3 || parts.some(isNaN)) {
    alert("–í–≤–µ–¥–∏—Ç–µ –≤—Ä–µ–º—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ HH:MM:SS, –Ω–∞–ø—Ä–∏–º–µ—Ä 12:00:00");
    return;
  }

  // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ —Å–µ–∫—É–Ω–¥—ã
  let h = parts[0], m = parts[1], s = parts[2];
  let total = h * 3600 + m * 60 + s;

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è
  countdown = total;
  updateTimer();

  // –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É —É–º–µ–Ω—å—à–∞–µ–º –≤—Ä–µ–º—è
  timerInterval = setInterval(() => {
    countdown--;
    updateTimer();
  }, 1000);
}

function applyData(){
  document.getElementById("phone").textContent = document.getElementById("inputPhone").value;
  document.getElementById("amount1").textContent = document.getElementById("inputAmt1").value;
  document.getElementById("amount2").textContent = document.getElementById("inputAmt2").value;
  document.getElementById("username").textContent = document.getElementById("inputName").value;
  document.getElementById("timer").textContent = document.getElementById("inputTimer").value;
}


async function recordVideo() {
  const capture = document.getElementById("captureZone");
  const controls = document.getElementById("controls");
  controls.style.display = "none";

  // ‚è≥ –∂–¥–µ–º, —á—Ç–æ–±—ã —Ñ–æ–Ω –∏ —à—Ä–∏—Ñ—Ç —É—Å–ø–µ–ª–∏ –ø—Ä–æ–≥—Ä—É–∑–∏—Ç—å—Å—è
  await new Promise(r => setTimeout(r, 500));

  const canvas = document.getElementById("canvasRecorder");
  const rect = capture.getBoundingClientRect();
  canvas.width = rect.width;
  canvas.height = rect.height;

  const ctx = canvas.getContext("2d");
  const fps = 30;
  const stream = canvas.captureStream(fps);
  const recorder = new MediaRecorder(stream, { mimeType: "video/webm; codecs=vp9" });
  let chunks = [];

  recorder.ondataavailable = e => chunks.push(e.data);
  recorder.onstop = () => {
    const blob = new Blob(chunks, { type: "video/webm" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "drift_countdown.webm";
    a.click();
    URL.revokeObjectURL(url);
    controls.style.display = "block";
  };

  // üîπ –ø—Ä–æ–≥–æ–Ω—è–µ–º –ø–µ—Ä–≤—ã–π –∫–∞–¥—Ä html2canvas –∑–∞—Ä–∞–Ω–µ–µ
  await html2canvas(capture, { backgroundColor: null, useCORS: true });

  // —Ç–µ–ø–µ—Ä—å –∑–∞–ø—É—Å–∫–∞–µ–º –∑–∞–ø–∏—Å—å
  recorder.start();
  startCountdown();

  const endTime = Date.now() + 7000;
  function drawFrame() {
    html2canvas(capture, { backgroundColor: null, useCORS: true, scale: 1 })
      .then(cnv => {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.drawImage(cnv, 0, 0, canvas.width, canvas.height);
      })
      .catch(err => console.error("Canvas frame error:", err));

    if (Date.now() < endTime) {
      requestAnimationFrame(drawFrame);
    } else {
      setTimeout(() => recorder.stop(), 500);
    }
  }

  drawFrame();
}

const s = document.createElement("script");
s.src = "https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js";
document.head.appendChild(s);
</script>
</body>
</html>

